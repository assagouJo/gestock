<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style>
body { 
    font-family: Arial; 
    font-size: 14px;
}
h2 { margin-bottom: 5px; }
p { margin-top: 0; }

table { 
    width: 100%; 
    border-collapse: collapse; 
    margin-top: 10px;
}

th, td { 
    border: 1px solid #000; 
    padding: 6px; 
    text-align: center;
}

th { 
    background: #eee; 
}
.section-title {
    margin-top: 25px;
    font-weight: bold;
}
</style>
</head>
<body>

<h2>Rapport Client : {{ client.nom_client }}</h2>
<p>
    ventes: {{ ventes|length }} 
</p>
<p>
    paiements: {{ paiements|length }}
</p>

<p>
Total facturÃ© : {{ total | money }} <br>
Total payÃ© : {{ total_paye | money }} <br>
Reste : {{ reste | money }}
</p>

<h4 class="section-title">ðŸ“„ DÃ©tail des ventes</h4>

<table>
<thead>
<tr>
<th>Date</th>
<th>Total</th>
<th>PayÃ©</th>
<th>Reste</th>
</tr>
</thead>
<tbody>
{% for v in ventes %}
<tr>
<td>{{ v.date_vente.strftime('%d/%m/%Y') }}</td>
<td>{{ v.total | money }}</td>
<td>{{ v.montant_paye | money }}</td>
<td>{{ v.reste_a_payer | money }}</td>
</tr>
{% endfor %}
</tbody>
</table>

<h4 class="section-title">ðŸ’µ DÃ©tail des paiements</h4>

<table>
<thead>
<tr>
<th>Date</th>
<th>Montant</th>
<th>Vente ID</th>
<th>Mode de paiement</th>
<th>NumÃ©ro (si virement / cheque)</th>
</tr>
</thead>
<tbody>
{% for p in paiements %}
<tr>
<td>{{ p.date_paiement.strftime('%d/%m/%Y') }}</td>
<td>{{ p.montant | money }}</td>
<td>#{{ p.vente_id }}</td>
<td>{{ p.mode or '-' }}</td>
<td>
    {% if p.mode and p.mode.lower() in ['virement', 'cheque'] %}
        {{ p.reference_paiement or '-' }}
    {% else %}
        -
    {% endif %}
</td>
</tr>
{% endfor %}
</tbody>
</table>

</body>
</html>
