{% extends "base_print.html" %}
{% block title %}Facture | gestock{% endblock %}

{% block styles %}
<link rel="stylesheet" href="/static/style/facture.css">
{% endblock %}

{% block content %}
<div class="invoice-wrapper">

    <!-- ================= LOGO ================= -->
    <div class="header">
        {% if compagnie and compagnie.logo %}
        <img src="{{ compagnie.logo }}" alt="Logo" class="logo">
        {% endif %}
    </div>

    <hr>

    <!-- ================= INFOS FACTURE ================= -->
    <div class="info-section">

        <!-- CLIENT -->
        <div class="client-info">
            <h3>FACTURE √Ä :</h3>
            <p><strong>{{ facture.vente.client.nom_client }}</strong></p>
            <p>{{ facture.vente.client.adresse_email if compagnie else '' }}</p>
            <p>{{ facture.vente.client.telephone if compagnie else '' }}</p>
        </div>

        <!-- DETAILS FACTURE -->
        <div class="facture-info">
            <table>
                <tr>
                    <th>F_N¬∞ :</th>
                    <td>{{ facture.numero }}</td>
                </tr>
                <tr>
                    <th>Date :</th>
                    <td>{{ facture.date_facture.strftime('%d/%m/%Y') }}</td>
                </tr>
                <tr>
                    <th>Statut :</th>
                    <td>
                        {% if facture.statut == "paye" %}
                            <span class="badge success">Facture Sold√©e</span>
                        {% elif facture.statut == "partiel" %}
                            <span class="badge warning">Paiement Partiel</span>
                        {% else %}
                            <span class="badge danger">Facture Impay√©e</span>
                        {% endif %}
                    </td>
                </tr>
            </table>
        </div>

    </div>

    <!-- ================= LIGNES ================= -->
    <div class="table-section">
        <table class="main-table">
            <thead>
                <tr>
                    <th>D√©signation</th>
                    <th>Conditionnement</th>
                    <th class="center">Qt√©</th>
                    <th class="right">Prix unitaire</th>
                    <th class="right">Total</th>
                </tr>
            </thead>
            <tbody>
                {% for ligne in facture.vente.lignes %}
                <tr>
                    <td>{{ ligne.stock.produit.nom_produit }}</td>
                    <td>{{ ligne.stock.type_conditionnement.value|capitalize }}</td>
                    <td class="right">{{ ligne.quantite }}</td>
                    <td class="right">{{ ligne.prix_unitaire | money }}</td>
                    <td class="right">{{ (ligne.quantite * ligne.prix_unitaire) | money }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- ================= TOTAUX ================= -->
    <div class="total-section">
        <table>
            <tr>
                <th>Total</th>
                <td class="right">{{ facture.total | money }}</td>
            </tr>
            <tr>
                <th>Pay√©</th>
                <td class="right">{{ facture.vente.montant_paye | money }}</td>
            </tr>
            <tr class="highlight">
                <th>Reste √† payer</th>
                <td class="right bold">{{ facture.reste_a_payer | money }}</td>
            </tr>
        </table>
    </div>

    <hr>

    <!-- ================= FOOTER ================= -->
    <div class="footer">
        <div class="footer-left">
            <p>RCCM : {{ compagnie.numero_rcc if compagnie else '' }}</p>
            <p>üìû {{ compagnie.telephone if compagnie else '' }}</p>
        </div>

        <div class="footer-center">
            <p>{{ compagnie.email if compagnie else '' }}</p>
            <p>{{ compagnie.adresse if compagnie else '' }}</p>
        </div>

        <div class="footer-right">
            Merci pour votre confiance üôè
        </div>
    </div>

    <!-- ================= ACTIONS ================= -->
    <div class="actions no-print">
        <button onclick="window.print()">üñ®Ô∏è Imprimer</button>
        <a href="{{ url_for('liste_factures') }}">‚¨Ö Retour</a>
    </div>

</div>
{% endblock %}
